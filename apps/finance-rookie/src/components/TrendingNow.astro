---
import ArticleBadges from "./ArticleBadges.astro";
import { renderKw } from "../lib/kw";

const { items = [], getCategoryLabel } = Astro.props;
---
<section class="section-block bg-bg-alt">
  <div class="container space-y-8">
    <div class="flex flex-col gap-3 md:flex-row md:items-end md:justify-between">
      <div>
        <p class="text-[0.65rem] font-semibold uppercase tracking-[0.35em] text-muted">Trending now</p>
        <h2 class="font-heading text-2xl md:text-3xl">
          Le storie che muovono i mercati oggi
        </h2>
      </div>
      <a href="/category/trending" class="text-xs uppercase tracking-[0.35em] text-muted hover:text-accent">
        Tutti i trend
      </a>
    </div>
    <div class="grid gap-8 md:grid-cols-3">
      {items.map((article, index) => (
        <article class="group border border-border bg-white p-8 transition-all duration-200 hover:-translate-y-1 hover:border-black/30 hover:shadow-sm">
          <div class="flex items-center justify-between">
            <span class="text-6xl font-semibold text-accent/90 md:text-7xl">
              {String(index + 1).padStart(2, "0")}
            </span>
            <ArticleBadges article={article} />
          </div>
          <p class="mt-4 text-[0.65rem] uppercase tracking-[0.3em] text-muted">
            {getCategoryLabel?.(article.data.category) ?? article.data.category}
          </p>
          <h3 class="mt-3 font-heading text-xl leading-tight group-hover:underline">
            <a href={`/article/${article.slug}`}>{article.data.title}</a>
          </h3>
          <p class="mt-3 text-sm text-muted">
            {renderKw(article.data.excerpt).map((node) =>
              node.type === "mark" ? <mark class="kw-mark">{node.value}</mark> : node.value
            )}
          </p>
          <span class="mt-5 inline-flex items-center gap-2 text-xs uppercase tracking-[0.3em] text-muted">
            Leggi
            <span aria-hidden="true">â†’</span>
          </span>
        </article>
      ))}
    </div>
  </div>
</section>
