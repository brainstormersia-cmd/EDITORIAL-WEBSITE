---
import BaseLayout from "./BaseLayout.astro";
import AuthorByline from "@theme/components/AuthorByline.astro";
import AssistantSummary from "@theme/components/AssistantSummary.astro";
import { SITE_CONFIG } from "../site.config";

const { frontmatter, image, content, url } = Astro.props;
const canonical = `${SITE_CONFIG.siteUrl}${url}`;
const imageSrc = image?.src ?? frontmatter.mainImage ?? "/images/hero-finanza.svg";
const imageUrl = imageSrc ? `${SITE_CONFIG.siteUrl}${imageSrc}` : `${SITE_CONFIG.siteUrl}/images/hero-finanza.svg`;
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "NewsArticle",
  headline: frontmatter.title,
  datePublished: frontmatter.pubDate,
  author: {
    "@type": "Person",
    name: frontmatter.author
  },
  image: imageUrl,
  description: frontmatter.description
};
---
<BaseLayout title={frontmatter.title} description={frontmatter.description} image={imageSrc} canonical={canonical}>
  <article class="container py-12">
    <span class="inline-flex bg-accent text-fg text-xs font-semibold uppercase tracking-[0.3em] px-3 py-1">
      {frontmatter.category}
    </span>
    <h1 class="text-4xl md:text-5xl font-bold mt-3">{frontmatter.title}</h1>
    <div class="mt-4">
      <AuthorByline
        author={frontmatter.author}
        authorImage={frontmatter.authorImage}
        date={frontmatter.pubDate}
        content={content}
      />
    </div>
    <div class="mt-8 mb-10 max-w-3xl mx-auto">
      <div class="aspect-video border border-border">
        <img
          src={imageSrc}
          alt={frontmatter.title ?? "Cover articolo"}
          width="1200"
          height="675"
          class="w-full h-full object-cover"
          loading="lazy"
        />
      </div>
    </div>
    <div class="article-content prose prose-lg mt-10 max-w-3xl">
      <slot />
      <AssistantSummary />
    </div>
  </article>
  <script type="application/ld+json" is:inline>{JSON.stringify(jsonLd)}</script>
</BaseLayout>
