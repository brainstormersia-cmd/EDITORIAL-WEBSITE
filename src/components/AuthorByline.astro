---
import { readingTime } from "../utils/readingTime";

const { authorName, authorAvatar, author, authorImage, date, readTime, content } = Astro.props;
const authorData = typeof author === "object" && author ? author : null;
const formattedDate = new Date(date).toLocaleDateString("it-IT", {
  day: "numeric",
  month: "long",
  year: "numeric"
});
const safeAuthor =
  authorData?.name?.trim() ||
  (authorName ?? author)?.trim() ||
  "Redazione FinanceRookie";
const avatar =
  authorData?.avatarUrl ||
  authorAvatar ||
  authorImage ||
  "/images/avatar-redazione.svg";
const time =
  typeof readTime === "number" ? `${readTime} min lettura` : readTime ?? readingTime(content ?? "");
---
<div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
  <div class="flex items-center gap-3">
    <img
      src={avatar}
      alt={safeAuthor}
      class="h-9 w-9 rounded-full border border-border object-cover"
      width="36"
      height="36"
      loading="lazy"
    />
    <div>
      <p class="text-sm font-semibold">{safeAuthor}</p>
      <p class="text-xs text-muted uppercase tracking-[0.3em]">{formattedDate} Â· {time}</p>
    </div>
  </div>
  <div class="flex items-center gap-4 text-xs uppercase tracking-[0.35em] text-muted">
    <button class="hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent">
      Share
    </button>
    <button class="hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent">
      Copia
    </button>
    <button class="hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent">
      Salva
    </button>
  </div>
</div>
